var websiteName=document.getElementById("bookmarkName");var websiteURL=document.getElementById("bookmarkURL");var submitBtn=document.getElementById("submitBtn");var tableContent=document.getElementById("tableContent");var deleteBtns;var visitBtns;var closeBtn=document.getElementById("closeBtn");var alertBox=document.querySelector(".box-info");var bookmarks=[];var nameRegex=/^\w{3,}(\s+\w+)*$/;var urlRegex=/^(https?:\/\/)?(w{3}\.)?\w+\.\w{2,}\/?(:\d{2,5})?(\/\w+)*$/;if(localStorage.getItem("bookmarksList")){bookmarks=JSON.parse(localStorage.getItem("bookmarksList"));for(var x=0;x<bookmarks.length;x++){displayBookmark(x)}}
function clearInput(){websiteName.value="";websiteURL.value=""}
function displayBookmark(indexOfWebsite){var userURL=bookmarks[indexOfWebsite].websiteURL;var urlRegex=/^https?:\/\//g;if(urlRegex.test(userURL)){validURL=userURL;fixedURL=validURL.split("").splice(validURL.match(urlRegex)[0].length).join("")}else{var fixedURL=userURL;validURL=`https://${userURL}`}
var newBookmark=`
              <tr>
                <td>${indexOfWebsite + 1}</td>
                <td>${bookmarks[indexOfWebsite].websiteName}</td>              
                <td>
                  <button class="btn btn-success visitButton" data-index="${indexOfWebsite}">
                    Visit
                  </button>
                </td>
                <td>
                  <button class="btn btn-danger deleteButton" data-index="${indexOfWebsite}">

                    Delete
                  </button>
                </td>
            </tr>
            `;tableContent.innerHTML+=newBookmark;deleteBtns=document.querySelectorAll(".deleteButton");if(deleteBtns){for(var j=0;j<deleteBtns.length;j++){deleteBtns[j].addEventListener("click",function(e){deleteBookmark(e)})}}
visitBtns=document.querySelectorAll(".visitButton");if(visitBtns){for(var l=0;l<visitBtns.length;l++){visitBtns[l].addEventListener("click",function(e){visitWebsite(e)})}}}
function capitalize(str){let strArr=str.split("");strArr[0]=strArr[0].toUpperCase();return strArr.join("")}
submitBtn.addEventListener("click",function(){if(websiteName.classList.contains("is-valid")&&websiteURL.classList.contains("is-valid")){var bookmark={websiteName:capitalize(websiteName.value),websiteURL:websiteURL.value,};bookmarks.push(bookmark);localStorage.setItem("bookmarksList",JSON.stringify(bookmarks));displayBookmark(bookmarks.length-1);clearInput();websiteName.classList.remove("is-valid");websiteURL.classList.remove("is-valid")}else{alertBox.classList.remove("d-none")}});function deleteBookmark(e){tableContent.innerHTML="";var deletedUrlIndex=e.target.dataset.index;bookmarks.splice(deletedUrlIndex,1);for(var k=0;k<bookmarks.length;k++){displayBookmark(k)}
localStorage.setItem("bookmarksList",JSON.stringify(bookmarks))}
function visitWebsite(e){var websiteIndex=e.target.dataset.index;var urlRegex=/^https?:\/\//;if(urlRegex.test(bookmarks[websiteIndex].websiteURL)){open(bookmarks[websiteIndex].websiteURL)}else{open(`https://${bookmarks[websiteIndex].websiteURL}`)}}
websiteName.addEventListener("input",function(){validate(websiteName,nameRegex)});websiteURL.addEventListener("input",function(){validate(websiteURL,urlRegex)});function validate(element,regex){var testRegex=regex;if(testRegex.test(element.value)){element.classList.add("is-valid");element.classList.remove("is-invalid")}else{element.classList.add("is-invalid");element.classList.remove("is-valid")}}
function closeAlert(){alertBox.classList.add("d-none")}
document.addEventListener("click",function(e){if(e.target.classList.contains("box-info")){closeAlert()}})